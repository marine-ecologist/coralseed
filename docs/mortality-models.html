<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2023-10-02" />

<title>Additional larval mortality through time</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="coralseed.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">coralseed</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="theory.html">Theory</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Parameterisation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="competency-models.html">Larval competency</a>
    </li>
    <li>
      <a href="mortality-models.html">Larval mortality</a>
    </li>
    <li>
      <a href="settlement-models.html">Larval settlement</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Instructions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="instructions.html">1. Run coralseed</a>
    </li>
    <li>
      <a href="visualise-coralseed.html">2. Visualise coralseed outputs</a>
    </li>
    <li>
      <a href="parallel-multicore.html">3. Parallel/multicore processing</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Outputs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="restoration-footprint.html">Spatial footprint of restoration</a>
    </li>
    <li>
      <a href="variance-partitioning.html">Partitioning model variance</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Lizard Island (2022)</li>
    <li>
      <a href="example-mermaid.html">Mermaid Bay</a>
    </li>
    <li>
      <a href="example-watsons.html">Watsons North</a>
    </li>
    <li>
      <a href="example-palfrey.html">Palfrey North</a>
    </li>
    <li>
      <a href="example-spawnhub.html">Spawn Hub</a>
    </li>
    <li>
      <a href="example-clamgarden.html">Clam Garden</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Additional larval mortality through
time</h1>
<h4 class="date">2023-10-02</h4>

</div>


<p><code>coralseed</code> incorporates an additional parameter for
mortality in early dispersal/settlement stages. While the
time-to-competency models don’t explicitly include a mortality
component, they do account for null settlement (presumably due a lack of
fitness) in individuals that remain uncompetent by the end time point.
The additional mortality component in <code>coralseed</code> accounts
for exogenous sources of mortality otherwise unaccounted for in
dispersal or larval development - for example planktivory or
entanglement.</p>
<div id="survivorship-curves" class="section level3">
<h3>1. Survivorship curves</h3>
<p>Due to a complete lack of data on these factors,
<code>coralseed</code> fits age-specific mortality curves with three
generalised forms:</p>
<ul>
<li><p><strong>Type I survivorship</strong>: high age-specific survival
probability in early and middle dispersal, followed by a increasing
mortality and rapid decline in survival in late stage
dispersal.</p></li>
<li><p><strong>Type II survivorship</strong>: constant mortality through
time with a fixed probability of survival</p></li>
<li><p><strong>Type III survivorship</strong>: high mortality in early
stages with low rates of mortality and high probability of survival in
late stage dispersal.</p></li>
</ul>
<p>Type I survival is consistent with higher mortality in late stage
dispersal which simulates increasing planktivory as larvae disperse
across habitats in the water column. Type III mortality is consistent
with higher mortality in early stages pre-dispersal, which is consistent
with higher entrapment in algal turfs or local-planktivory above reef
habitats.</p>
</div>
<div id="survivorship-parameterisation" class="section level3">
<h3>2. Survivorship parameterisation</h3>
<p>Mortality is parameterised as the proportion of larvae removed in a
24hr period, where 1 = 100% mortality over a 24hr period, and 0.01 = 1%
mortality over a 24hr period. To simulate survival curves, mortality is
parameterised following a weibull distribution with a fixed scale and
varying shape parameters (0, 1.5, 2.5). For example, for n = 0.1 for a
cohort of 1000 individual larvae gives the following survival curves
over a 24h period:</p>
<pre class="r"><code>n_mortality=100

typeI_time &lt;- survivorship_type(n_mortality, 2.5, 1440)
typeII_time &lt;- survivorship_type(n_mortality, 1.5, 1440)
typeIII_time &lt;- survivorship_type(n_mortality, 0.5, 1440)


  survivorship_loop &lt;- NULL
    for (i in 1:(n_mortality)) {
      # Fit the types to the individuals and sample the time of death
      typeI_time &lt;- survivorship_type(n_mortality, 2.5, 1440)
      typeII_time &lt;- survivorship_type(n_mortality, 1.5, 1440)
      typeIII_time &lt;- survivorship_type(n_mortality, 0.5, 1440)

      # Combine into a data frame
      loop_results &lt;- data.frame(
        type = rep(c(&quot;typeI&quot;, &quot;typeII&quot;, &quot;typeIII&quot;), each = n_mortality),
        time = c(typeI_time, typeII_time, typeIII_time)
      ) |&gt;
        dplyr::group_by(type) |&gt;
        dplyr::arrange(type, time) |&gt;
        dplyr::ungroup() |&gt;
        dplyr::mutate(n = rep(seq(1, n_mortality, 1), 3))
      survivorship_loop[[i]] &lt;- loop_results |&gt; mutate(loop=as.factor(i))
    }

    survivorship_loop &lt;- do.call(rbind, survivorship_loop) 

    survivorship_singlesim &lt;- survivorship_loop |&gt; group_by(loop) |&gt; filter(loop==1)
    
  ggplot2::ggplot() + facet_wrap(~type) +
      ggplot2::geom_abline(intercept = 0, slope = 4.12, linetype=&quot;dashed&quot;, color=&quot;grey&quot;) +
      ggplot2::theme_bw() + xlab(&quot;Time following larval release (hrs)&quot;) + ylab(&quot;n larvae&quot;) +
      ggplot2::geom_point(data = survivorship_loop, ggplot2::aes(x = time/60, y = n, color = as.factor(type)), show.legend=FALSE, size = 1.5, alpha = 0.01) +
      ggplot2::geom_point(data = survivorship_singlesim, ggplot2::aes(x = time/60, y = n), color=&quot;black&quot;, size = 1.5, alpha = 0.5) +
      ggplot2::scale_color_manual(values = viridis::viridis(n = 5)[-5]) +
      ggplot2::guides(color = ggplot2::guide_legend(override.aes = list(alpha = 1.0, size = 2))) +
      ggplot2::theme(legend.position = c(0.86,0.3), legend.title = element_blank(), legend.background = element_blank(), 
                     legend.key = element_blank(), axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8))</code></pre>
<p><img src="mortality-models_files/figure-html/unnamed-chunk-1-1.png" width="768" />
The background coloured points represent n=100 simulations of the same
distribution with randomised subsets (see code for details). As shape
and scale parameters are not intuitive to set, the current version of
<code>coralseed</code> keeps mortality fixed as the three survival curve
types, but can easily be changed to accept variable parameters or
different distributions.</p>
</div>
<div id="cohort-survival" class="section level3">
<h3>3. Cohort survival</h3>
<p>The above curves represent 0.1 or 10% mortality of a cohort of 1000
individuals over 24hrs. Viewed as a whole cohort, mortality curves look
like this (vertical red lines = 6hr and 12hr time slices). Note that
mortality is fit <strong>prior</strong> to settlement, so accounts for
<strong>additional</strong> parameterisation of exogenous mortality -
ontop of existing mortality in the incompetent component of the
time-to-competency models (i.e. larvae that never made it to settlement
in experiments due to mortality or lack of fitness).</p>
<pre class="r"><code>  ggplot2::ggplot() + 
      ggplot2::theme_bw() + xlab(&quot;Time following larval release (hrs)&quot;) + ylab(&quot;Percent mortality&quot;) +
      ggplot2::geom_point(data = survivorship_loop, ggplot2::aes(x = time/60, y = n, color = as.factor(type)), size = 0.5, alpha = 0.1) +
      ggplot2::scale_color_manual(values = viridis::viridis(n = 4)[-4]) +
      ggplot2::guides(color = ggplot2::guide_legend(override.aes = list(alpha = 1.0, size = 2))) +
      ggplot2::theme(legend.position = c(0.86,0.3), legend.title = element_blank(), legend.background = element_blank(), 
                     legend.key = element_blank(), axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8)) +
      ggplot2::geom_vline(xintercept=6, alpha=0.6, linewidth=0.5, colour=&quot;darkred&quot;) +
      ggplot2::geom_vline(xintercept=12, alpha=0.6, linewidth=0.5, colour=&quot;darkred&quot;) +
      ggplot2::scale_y_continuous(breaks=c(0,100,seq(200,1000,200)), limits=c(0,1000))</code></pre>
<p><img src="mortality-models_files/figure-html/unnamed-chunk-2-1.png" width="768" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
