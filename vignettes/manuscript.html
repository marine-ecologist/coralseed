<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>coralseed [v1.1.0]: a spatially explicit probabilistic model of larval seeding for large scale restoration</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="manuscript_files/libs/clipboard/clipboard.min.js"></script>
<script src="manuscript_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="manuscript_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="manuscript_files/libs/quarto-html/popper.min.js"></script>
<script src="manuscript_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="manuscript_files/libs/quarto-html/anchor.min.js"></script>
<link href="manuscript_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="manuscript_files/libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="manuscript_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="manuscript_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="manuscript_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">coralseed [v1.1.0]: a spatially explicit probabilistic model of larval seeding for large scale restoration</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>G. Roff<sup>1,2</sup>, M. Gouezo<sup>1,2</sup>, L. Hardiman<sup>1</sup>, G. Carlin<sup>1</sup>, D.T. Thomson<sup>1</sup>, P. Harrison<sup>2</sup>, C. Doropoulos<sup>1</sup></p>
<p><sup>1</sup> CSIRO Environment, St Lucia, Queensland, Australia</p>
<p><sup>2</sup> Faculty of Science and Engineering, Southern Cross University, Military Road, East Lismore, 2480, NSW, Australia</p>
<p><em>Correspondence to</em>: George Roff (george.roff@csiro.au)</p>
<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">Abstract</h2>
<p>coralseed&nbsp;is a spatially explicit probabilistic model that aims to&nbsp;quantify the spatial footprint of propagule reseeding for restoration projects. The model is based on input from high-resolution hydrodynamic models that track individual particles through space and time. By including key parameters for larval biology traits including&nbsp;developmental rates, habitat specific substrate settlement preferences, and swimming behaviour, individual-based probability of larval settlement – the transition of planktonic, motile larvae to attached and metamorphosed polyps on the reef substrata – can be modelled for 10<sup>5</sup>&nbsp;- 10<sup>7</sup>&nbsp;larvae. Individual-based settlement probability of dispersal paths are then overlaid onto high-resolution habitat maps to form a spatially-explicit model of settlement following release of coral larvae. coralseed&nbsp;aims to provide insight into key knowledge gaps in larval restoration and insights into large-scale larval dispersal and settlement processes. By varying initial model parameters (e.g.&nbsp;tidal currents, time of release, larval development, larval densities, location of release sites), a simulation modelling approach can be used to quantify the likely spatial footprint of propagule releases and expected settlement densities. Ultimately, the coralseed platform allows for optimisation and upscaling of larval reseeding programs on the Great Barrier Reef and elsewhere, aiding managers and planners in the spatial prioritisation of restoration operations to achieve the best possible outcomes. The platform can also be applied to other key coastal marine organisms such as oyster reefs, mangrove forests, and seagrass meadows. coralseed is available as an R package via remotes::install_github(“marine-ecologist/coralseed”).</p>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">1. Introduction</h2>
<p>Coastal ecosystems, including seagrasses, saltmarshes, and mangroves, provide essential services such as shoreline stabilization, carbon sequestration, and biodiversity support (Duarte et al., 2013). However, these habitats face increasing degradation due to anthropogenic pressures, climate change, and habitat fragmentation (Waycott et al., 2009). As a result, restoration projects focusing on propagule reseeding have gained prominence as scalable approaches to restore ecosystem function and biodiversity (Vanderklift et al.&nbsp;2020). Large-scale reseeding programs, particularly for vegetated coastal systems, have demonstrated success in restoring habitat continuity and ecosystem resilience (van Katwijk et al., 2016). While these approaches show promise in scaling restoration efforts, a key challenge in optimizing such approaches is predicting where propagules disperse and settle following their release. Understanding patterns of dispersal and the subsequent spatial footprint of reseeding restoration efforts is critical for evaluating cost-benefit trade-offs with other restoration techniques, improving strategic planning, and scaling up operations effectively (Lowe et al., 2015). In terrestrial systems, probabilistic modelling approaches are increasingly employed to quantify dispersal patterns and their interaction with environmental conditions (e.g, van Vizentin-Bugon et al 2022, Ditmer et al 2023), enabling improved decision-making frameworks.</p>
<p>In coastal ecosystems, restoration of vegetated coastal ecosystems such as seagrasses and mangroves often involves passive propagules, whose dispersal patterns are easier to predict (Orth et al., 2006). In contrast, restoring of invertebrate habitats such as tropical coral reefs and temperate oyster reefs through larval reseeding presents additional challenges due to the complexity of substrates and larval behaviour in selecting habitats (e.g., Babcock &amp; Mundy 1996, Raimondi &amp; Morse 2000). Fine-scale hydrodynamics, including tidal currents, eddies, and vertical stratification, influence larval dispersal in three-dimensional space (Cowen et al., 2000), while larval swimming behaviour that actively interacts with water column structure makes dispersal predictions complex (Leis, 2007). Further complicating predictions of larval dispersal is understanding competency rates—the time it takes to and during which larvae are capable of settlement—which influences their dispersal window, affecting the distance and likelihood of reaching suitable habitats (Graham et al.&nbsp;2008, Connolly &amp; Baird 2010). Even when larvae are competent, substrate electivity or preferences for specific settlement surfaces may prevent successful settlement (e.g., Harrington et al.&nbsp;2004, Abdul Wahab et al 2023, Randall et al 2025), emphasizing the need for detailed habitat data, hydrodynamic models, and larval behavioural parameterisation to improve predictions.</p>
<p>In part due to such complexities, modelling tools that are effective at the finer spatial scales of applied restoration operations (100s of metres to hectares; Bayraktarov et al.&nbsp;2016) remain scarce, limiting the ability predict the broader spatial footprint and outcomes of larval reseeding efforts (but see Gouezo et al.&nbsp;2025 for recent advancements). Access to such tools would substantially improve resource managers capacity to decide upon site selection and optimise approaches and facilitate evidence-based restoration plans and assessments of long-term ecological benefits. To address these challenges, we developed ‘coralseed’, a spatially explicit probabilistic model designed to simulate larval dispersal and settlement patterns following propagule releases. By incorporating high-resolution oceanographic data, biological traits, and habitat preferences, coralseed significantly improves spatial prediction of restoration outcomes, facilitating dynamic decision making for conservation science.</p>
</section>
<section id="overview-of-the-coralseed-v1.1.0-model" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-the-coralseed-v1.1.0-model">2. Overview of the coralseed v1.1.0 model</h2>
<p>‘coralseed’ v1.1.0 is a spatially explicit probabilistic model that aims to quantify the effect size and spatial footprint of larval reseeding from restoration projects. The model is based on input from high-resolution hydrodynamic models that track individual particles through space and time (e.g.&nbsp;Bruyère et al 2023, Grech et al 2016, Ani et al 2024, Gouezo et al 2025). By parameterising larval biology traits including competency rates, habitat specific substrate settlement preferences, and swimming behaviour, individual-based probability of settlement can be modelled for 105 - 107 larvae. Individual-based settlement probability of dispersal paths are then overlaid onto high-resolution habitat maps to form a spatially-explicit model of settlement patterns and densities following the release of coral larvae. 2.1 coralseed modelling workflow</p>
<p>‘coralseed’ differs from existing modelling approaches of coral reefs in three key ways: 1) by adopting an individual-based approach, the model allows for tracking of individual larvae within cohorts through space and time, 2) by tracking each larvae in cartesian space, the model allows for spatially explicit patterns of dispersal, settlement, and growth across coral reef seascapes, and 3) by allowing for flexibility in input particle tracking simulated data file format and parameterisation of functions, the model facilitates parameterisations of ecological processes (e.g.&nbsp;settlement, mortality, growth, electivity) and allows for use across a almost any dispersal simulation. Coupled with high-resolution hydrodynamic models that are constantly being tested and refined in the field (e.g.&nbsp;Gouezo et al 2025, Mason et al.&nbsp;2025) allows for high-resolution dispersal predictions at the scale of metres to 100s of metres.</p>
<section id="spatially-explicit-model-based-approach" class="level3">
<h3 class="anchored" data-anchor-id="spatially-explicit-model-based-approach">2.2 Spatially explicit model-based approach</h3>
<p>‘coralseed’ is based upon the premise of larval reseeding, where larvae are released onto coral reefs to “seed” adjacent substrates with juvenile corals, with the ultimate outcome of boosting densities of adult corals and/or increasing coral cover (Doropoulos et al 2019). The ‘coralseed’ workflow seeks to model this process by: 1) seeding larvae across particle tracks to quantify spatiotemporal trajectories of individuals (i.e., where are the larvae dispersing once released?), 2) predicting larval competency (time-to-settlement) along each particle track (i.e., when are larvae ready to settle after release?), 3) predicting trajectories of larvae during dispersal (i.e., are they passing across coral reef habitats?), 4) predicting the probability of settlement within habitats (i.e., will larvae elect to settle if they do pass a coral habitat?), 5) quantify the combined effects of competency and electivity on the probability of larval settlement (i.e., if the larvae are competent to settle, do they encounter a habitat and elect to settle?), and 6) what are the spatial patterns of dispersal and settlement (e.g.&nbsp;how far do larvae travel after release, and are there settlement ‘hotspots’ close to the point of release?). By varying initial model parameters (e.g., tidal currents, time of release, location of release sites, larval competency rates, larval densities), a simulation modelling approach can be used to quantify the likely spatial footprint and expected settlement densities, allowing for optimisation and upscaling of larval reseeding programs on the Great Barrier Reef and elsewhere.</p>
</section>
<section id="coralseed-r-package" class="level3">
<h3 class="anchored" data-anchor-id="coralseed-r-package">2.3 coralseed R package</h3>
<p>‘coralseed’ is available as an R ‘package’ (http://github.com/marine-ecologist/coralseed/). The package relies on the ‘sf’ package for spatial vector data processing, ‘brms’ package for Bayesian probabilistic modelling of ecological parameters, and the ‘tmap’ package for visualising data outputs.</p>
</section>
</section>
<section id="overview-of-the-coralseed-model" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-the-coralseed-model">3. Overview of the coralseed model</h2>
<p>‘coralseed’ v1.1.0 is a spatially explicit probabilistic model that aims to quantify the spatial footprint of larval reseeding from restoration projects.</p>
<section id="coralseed-background" class="level3">
<h3 class="anchored" data-anchor-id="coralseed-background">3.1 coralseed background</h3>
<p>coralseed is based upon the premise of larval reseeding, where larvae are released into the water column onto coral reefs to “seed” adjacent substrates with juvenile corals, with the ultimate outcome of boosting densities of adult corals and/or increasing coral cover (Doropoulos et al 2019). The model: 1) seeds larvae through particle tracks (i.e., where are the larvae dispersing once released?), 2) predicts larval competency (time-to-settlement) of larvae within each particle track (i.e.&nbsp;when are they ready to settle after being released?), 3) which habitats do the larvae cross when being dispersed (i.e.&nbsp;are they passing across coral reef habitats?), 4) what is the settlement potential within each of these habitats (i.e.&nbsp;will larvae elect to settle if they do pass?) 5) what is the combined probability of larval settlement (i.e.&nbsp;if the larvae are competent to settle, encounter a habitat, elect to settle), and 6) of all released larvae, what are the spatial patterns (e.g.&nbsp;how far to larvae travel after release? are there settlement ‘hotspots’?). By varying initial model parameters (e.g.&nbsp;tidal currents, time of release, location of release sites, larval competency rates, larval densities), a simulation modelling approach can be used to quantify the likely spatial footprint and expected settlement densities, allowing for optimisation and upscaling of larval reseeding programs on the Great Barrier Reef and elsewhere.</p>
</section>
<section id="spatially-explicit-modelling" class="level3">
<h3 class="anchored" data-anchor-id="spatially-explicit-modelling">3.2 Spatially explicit modelling</h3>
<p>To date, most region and local scale dispersal studies consider a particle to be ‘settled’ when they are competent and intersect with a reef habitat (e.g.&nbsp;Hock et al.&nbsp;2017, Figueiredo et al.&nbsp;2022, Ani et al 2024, Cresswell et al 2024). These studies assume that: all reef habitats are equal in term of settlement success, and that parameterised competency rates as discrete 24hr periods (Hock et al.&nbsp;2017, Figueiredo et al.&nbsp;2022) rather than modelling competency as a continuous process (but see Ani et al 2024 and Cresswell et al 2024 for finer-scale modelling of competency). While recent advances in metacommunity modelling allow for improved predictions of settlement across seascapes, model outputs quantify settlement at a site level (i.e.&nbsp;~0.3km to 1km), none of the existing modelling approaches allow for tracking of individual larvae or juvenile corals through space and time (i.e.&nbsp;4D modelling with cartesian coordinates [xyz] and a time trajectory).</p>
<p>`coralseed’ aims to improve on existing modelling approaches accurately predict spatial settlement patterns. The model approach 1) allows for spatially explicit tracking of larvae through time by modelling individual larvae along unique high-resolution particle tracks, 2) incorporates a high-resolution timeseries at 1-min intervals, allowing for fine-scale temporal modelling of competency and mortality along larval trajectories, 3) improves spatially explicit settlement patterns by incorporating habitat specific electivity at seascape scales, and 4) enables spatially explicit quantification of restoration outcomes by modelling total outputs (i.e.&nbsp;settled corals) from of an initial pool of seeded larvae.</p>
<p>`coralseed’ is also highly flexible in terms of dispersal models, including regional-scale modelling (e.g., ~200 m resolution OceanParcels particle tracks, Ani et al 2024) and high-resolution local-scale modelling (e.g.&nbsp;30 m resolution CONNIE particle tracks, Gouezo et al 2025).</p>
</section>
<section id="coralseed-v1.1.0-r-package" class="level3">
<h3 class="anchored" data-anchor-id="coralseed-v1.1.0-r-package">3.3 coralseed v1.1.0 R package</h3>
<p>coralseed is a series of functions combined as an R ‘package’ and is available via https://github.com/marine-ecologist/coralseed. coralseed uses the sf and stars packages (Pebesma &amp; Bivand 2023) for vector and raster data, tmap (Tennekes 2018), leaflet (Cheng et al 2024), and networkD3 (Allaire et al 2017) for data visualisation, and brms (Bürkner 2018) for Bayesian modelling of input parameters.</p>
</section>
</section>
<section id="coralseed-parameterisation" class="level2">
<h2 class="anchored" data-anchor-id="coralseed-parameterisation">4. coralseed parameterisation</h2>
<p>To parameterise the coralseed model, we used a range of published datasets, hydrodynamic models, and new experimental results from larval settlement assays. Where possible, coralseed has been written to be flexible in parameterisation, allowing the incorporation of different or new datasets, or different model fits to existing data to account for varying ecological functions (e.g., flexibility between the exponential, logarithmic, and Weibull functions when fitting models to settlement data).</p>
<section id="spatial-parameters" class="level3">
<h3 class="anchored" data-anchor-id="spatial-parameters">4.1 Spatial parameters</h3>
<p>Spatial parameterisation is critical in restoration models, particularly in accurately predicting pathways of larval dispersal, settlement, and determining the overall spatial footprint of restoration outcomes. Spatial parameterisation in coralseed v1.1.0 is individual-based, and functions by tracking larvae along dispersal paths and identifying whether trajectories intersect with suitable habitat for settlement.</p>
<section id="dispersal-paths" class="level4">
<h4 class="anchored" data-anchor-id="dispersal-paths">4.1.1 Dispersal paths</h4>
<p>The coralseed model employs detailed spatial tracking of individual coral larvae from their release point to potential settlement sites. It accepts dispersal path data as XY coordinates provided in the simple features (sf) POINT geometry format (see Table 1 for example). This approach allows each larva to be uniquely tracked using an ‘id’, with spatial positions (‘geometry’) captured at discrete temporal intervals (‘time’). Input data flexibility is a significant advantage of coralseed, as strict regular intervals in the input files are not mandatory. Instead, coralseed internally interpolates larval trajectories into consistent timesteps—commonly set at resolutions of either 1 or 5 minutes—ensuring robust and comparable outcomes across diverse input dispersal models. This flexibility accommodates variability in data availability and observational frequency, making coralseed suitable for integration with various dispersal modelling frameworks (Figure 1a).</p>
<pre class="table scrollable"><code>| id | time               | geometry                    |
|----|--------------------|-----------------------------|
| 0  | 16/12/2022 14:06   | POINT (1630092 8352332)     |
| 0  | 16/12/2022 14:17   | POINT (1630036 8352300)     |
| 0  | 16/12/2022 14:29   | POINT (1629975 8352271)     |
| 0  | 16/12/2022 14:41   | POINT (1629906 8352243)     |
| 0  | 16/12/2022 14:53   | POINT (1629821 8352205)     |
| 0  | 16/12/2022 15:05   | POINT (1629739 8352121)     |
| 0  | 16/12/2022 15:17   | POINT (1629697 8352018)     |
| 0  | 16/12/2022 15:29   | POINT (1629665 8351921)     |
| 0  | 16/12/2022 15:41   | POINT (1629646 8351828)     |
| 0  | 16/12/2022 15:53   | POINT (1629634 8351736)     |</code></pre>
<p>Bounding box: xmin: <strong>1629602</strong> ymin: <strong>8350374</strong> xmax: <strong>1630097</strong> ymax: <strong>8352354</strong><br>
Geometry type: <code>POINT</code> | Projected CRS: <strong>AGD84 / AMG zone 53</strong></p>
<p>coralseed&nbsp;has been validated against various particle tracking simulated data, such as from CONNIE (CONNectivity InterfacE; Gouezo et al., 2025) and oceanparcels (Ani et al., 2024), both simulated within the Great Barrier Reef. Given the current constraints in handling zarr&nbsp;data format (large N-dimensional typed arrays) within R, coralseed provides dedicated R functions specifically designed to facilitate direct conversions of oceanparcels outputs into sf-compatible formats, ensuring accessibility and usability across marine restoration projects.</p>
</section>
<section id="seascape-maps" class="level4">
<h4 class="anchored" data-anchor-id="seascape-maps">4.1.2 Seascape maps</h4>
<p>Predicting spatial patterns of coral larval settlement requires accurate mapping of benthic habitats to determine suitable settlement locations. To predict spatial patterns of larval settlement,&nbsp;coralseed&nbsp;tracks particle&nbsp;paths&nbsp;across benthic substrates to determine the probability of settlement based on habitat electivity (Figure 1c). The default habitat maps employed by coralseed originate from the high-resolution Allen Coral Atlas (Lyons et al., 2024). However, the model’s design allows for integration with other vector-based habitat maps (e.g., Andréfouët &amp; Bionaz, 2021), granting restoration practitioners the flexibility to apply region-specific or updated habitat information that may improve settlement predictions.</p>
<p>In coralseed v1.1.0, the suitability of substrates for coral settlement was assessed using a two-step procedure:</p>
<ol type="1">
<li><p><em>Exclusion of Non-Colonisable Substrates</em>:&nbsp;This step systematically removed substrates known to be unsuitable for coral larval settlement, including microalgal mats, seagrass beds, sandy areas, coral/algae-dominated regions, and rubble.</p></li>
<li><p><em>Stratification Colonisable Substrates</em>:&nbsp;The remaining substrates were classified according to geomorphic habitat categories provided by the Allen Coral Atlas, allowing for spatially explicit predictions of settlement outcomes based on habitat type. Both shallow lagoon&nbsp;and&nbsp;deep lagoon&nbsp;habitats were explicitly excluded due to their high-sediment loading and suboptimal habitats for coral larval settlement. The following geomorphic categories were included:</p></li>
</ol>
<p>Back Reef Slope&nbsp;•&nbsp;Sheltered Reef Slope&nbsp;•&nbsp;Plateau &nbsp;•&nbsp;Inner Reef Flat&nbsp;•&nbsp;Outer Reef Flat&nbsp;•&nbsp;Reef Slope&nbsp;•&nbsp;Reef Crest</p>
</section>
</section>
<section id="ecological-parameters" class="level3">
<h3 class="anchored" data-anchor-id="ecological-parameters">4.2 Ecological parameters</h3>
<section id="larval-competency" class="level4">
<h4 class="anchored" data-anchor-id="larval-competency">4.2.1 Larval competency</h4>
<p>The larval phase of corals and other benthic invertebrates (e.g., echinoderms, gastropods; Hadfield et al.&nbsp;2015) consists of a pre-competent phase, where development is still underway and larvae are not yet competent to settle, and a competent phase, where larvae are capable of settlement if suitable substrates are present (e.g., Connolly &amp; Baird 2010, Randall et al.&nbsp;2024). For modelling larval reseeding potential, understanding short-term (hourly) patterns of larval competency is critical. If larvae settle immediately following larval release (&lt;1-2 hours), the spatial footprint of restoration efforts will be small scale (&lt;100 m) and concentrated (high densities of settlers). If larval competency peaks 6-12 hours after release, the spatial footprint will be larger scale (&gt;1 km) and diffuse. Understanding such fine-scale patterns of larval competency allows for more complex larval deliveries such as leveraging slack current conditions to increase larval settlement densities over reduced dispersal footprints following larval reseeding efforts.<br>
In larval reseeding programs, larvae are cultured in aquaculture facilities on land (e.g., Edwards et al.&nbsp;2015, Pollock et al.&nbsp;2017, dela Cruz &amp; Harrison 2017, Severati et al.&nbsp;2024) or at sea (e.g., Heyward et al.&nbsp;2002, Omori et al.&nbsp;2007, Doropoulos et al.&nbsp;2019) and held until they reach optimal competency. Optimal competency is typically determined by i) adding n larvae to an inducer and quantifying the proportion settled after 10-24 hours, or ii) adding settlement substrata to larval cultures and quantifying the proportion of larvae that settle after 24-hours. Competency assays are repeated daily and larvae are then released onto the target reef area at peak competency, which is typically targeted to be &gt;50% of the cohort, to maximise the impact of larval reseeding. The metric “competency” has been defined experimentally in different ways. Typically, subsets of larvae from cultures are counted and added to conditioned tiles / crustose coralline algae fragments and assayed 24-hours later (e.g., Heyward &amp; Negri 1999, Connolly &amp; Baird 2010), with the proportion of settled/metamorphosed, swimming and “dead” larvae recorded. As coral larvae undergo a peak in competency in the days after fertilisation, these assays are critical in understanding settlement dynamics and are used in estimating dispersal potential (e.g., Connolly &amp; Baird 2010) and parameterise large-scale ecosystem models that include larval connectivity estimates (e.g., Condie et al 2021, Gouezo et al.&nbsp;2021, Bozec et al.&nbsp;2022) coralseed defines competency as the duration of time from larval release to settlement (from the perspective of larvae at n days old following fertilisation) to align with the propagule reseeding approach that is utilised in restoration operations. This definition differs from traditional studies of larval competency (e.g.&nbsp;Heyward &amp; Negri 1999, Connolly &amp; Baird 2010) and that derive larval competency as the proportion of n larvae settling in a 24-hour period across multiple days. The distinction is important, as coralseed models competency as continuous individual-based measures within a single cohort using hourly measurements, while traditional studies (and dispersal models, e.g.&nbsp;Ani et al 2024) define discrete (daily) timesteps across multiple cohorts. To parameterise coralseed, we conducted two separate competency assays: 1) using a single-species (Acropora tenuis) laboratory-reared culture at SeaSim (Australian Institute of Marine Science, Townsville) in November 2022, and 2) using multi-species larvae harvested from wild slicks collected from the northern Great Barrier Reef at Lizard Island in December 2022. The experiments tracked settlement of replicated cohorts of larvae (n=100 per replicate) at hourly timepoints (either 0 to 24-hours at SeaSims or 0 to 12-hours with wild spawn). Five replicate pre-conditioned settlement tiles were placed in individual 1-litre flow-through aquaria to simulate natural conditions, and 100 larvae released in each container at t0, beginning at 3.5 days following spawning at SeaSims and 4.5 days following spawning at Lizard Island. Tiles were imaged hourly following larval release using a high-resolution camera (Sony a7R IV) and in-water probe lens (Laowa 24mm) between t0-6 hours and again at ~t10 hours. The proportion of larvae able to settle through time was quantified by tracking individual attachment and subsequent metamorphosis of larvae on tiles at each time point. Results from both wild and lab cultured larvae were similar in that initial settlement occurred within the first 1-2 hours (10% and 6% at 2hrs respectively) and slowed at around 6-10 hours after release (16% and 20% respectively, Figure 1b). Settlement at 10 hours averaged 10 - 30% of total larvae, and settlement continued in both experiments without reaching a clear asymptote by either end point. Predictions for time-to-settlement for parameterising dispersal models (105 - 106 larvae) were obtained from draws from the posterior of the brms model outputs.</p>
</section>
<section id="larval-mortality" class="level4">
<h4 class="anchored" data-anchor-id="larval-mortality">4.2.2 Larval mortality</h4>
<p>coralseed incorporates an additional parameter for extrinsic mortality in early dispersal/settlement stages that accounts for exogenous sources of mortality otherwise unaccounted for in larval development such as planktivory (Fabricius et al 2004) or entanglement/entrapment in algal turfs (Birrell et al 2005). This parameter is independent to intrinsic mortality (i.e.&nbsp;genetic deformities, fertilisation defects) which is inherent in the parameterisation of time-to-competency curves based on experimental data (see 3.2.1). Given the complexities of the magnitude or shape of this distribution, extrinsic mortality in coralseed v1.1.0 is parameterised to approximate classic survival curves (i.e., Type I, Type II, Type III survival, sensu Odum 1953):</p>
<p>• Type I survivorship: high age-specific survival probability in early and middle dispersal, followed by an increasing mortality and rapid decline in survival in late-stage dispersal. • Type II survivorship: constant mortality through time with a fixed probability of survival • Type III survivorship: high mortality in early stages with low rates of mortality and high probability of survival in late-stage dispersal, most typical of marine invertebrate larvae.</p>
</section>
</section>
<section id="habitat-electivity" class="level3">
<h3 class="anchored" data-anchor-id="habitat-electivity">4.2.3 Habitat electivity</h3>
<p>The selection of habitats by coral larvae for settlement is key in determining growth and survival into the adult life-history stage (Price 2010). In laboratory experiments, coral larvae respond to specific biotic settlement cues from substrates dominated by early successional crustose coralline algae (Harrington et al.&nbsp;2004, Abdul Wahab et al 2023) and microbial biofilms associated with optimal shallow-water settlement habitats (Webster 2004), while avoiding habitats with negative outcomes such long-turf algae, sponges, and ascidians (Wakwella et al 2020). These patterns are consistent with large-scale field assessments of coral settlement, with a general pattern of higher coral settlement rates in forereef and reef slope areas compared to backreef and reef flat locations (Baird &amp; Hughes 1997, Arnold et al 2010, Doropoulos et al.&nbsp;2015). coralseed v0.1.1 uses data from settlement tiles from Lizard Island (Baird and Hughes 1998, Baird 2001) and other publications from the Great Barrier Reef (Harriot 1985, Mundy &amp; Babcock 1998, Baird 2001, Baird et al 2003, Doropoulos et al 2015) to parameterise settlement probability across different habitat types derived from the Allen Coral atlas spatial maps (section 3.1.2) where P=1 is absolute settlement and P=0 is no settlement:</p>
<p>• “Reef Crest” - high settlement probability (P = 0.9 ± 0.1) • “Reef Slope” - high settlement probability (P = 0.9 ± 0.1) • “Sheltered Reef Slope” - lower than exposed habitats (P = 0.7 ± 0.1) • “Back Reef Slope” - lower in sheltered slope habitats (P = 0.6 ± 0.1) • “Outer Reef Flat” - half the settlement of reef crest/slope (P = 0.45 ± 0.1) • “Inner Reef Flat” - senescent habitat, low settlement potential (P = 0.3 ± 0.1) • “Plateau” - deep (&gt;10m) habitat, low probability of settlement (P = 0.2 ± 0.1)</p>
<p>Habitat-specific settlement probabilities are then used to parameterise spatial maps by sampling from a normal distribution of the mean (± standard error) probability (Figure 1C).</p>
</section>
<section id="settlement-probability" class="level3">
<h3 class="anchored" data-anchor-id="settlement-probability">4.2.4 Settlement probability</h3>
<p>To determine settlement, the coralseed model takes the individual particle paths and maps settlement probability for each id according to habitats encountered along each trajectory. Note that this is not the probability of settlement but the probability of settlement if the larvae are competent (see 4.1.4 for further details). There are two caveats for determining larval settlement as currently implemented in coralseed:</p>
<ol type="1">
<li><p>Larval “attraction”: coralseed does not account for chemical cues from habitats with positive (or negative) settlement cues that may cause larvae to selectively swim towards (or away from) the area for settlement (see Dixson et al 2014). While dispersal models include a “halo” around reefs that if particles pass through, then larvae are allocated to that reef (e.g., Hock et al.&nbsp;2019), in practice this is hard to implement as i) particle tracks are hard-wired, and while spatial buffers can be used to identify habitats within a given distance, forcing settlement if p=1 is difficult using anything other than the rapid algorithm which produces unrealistic results, ii) while lab experiments demonstrate substrate electivity, the capacity of larvae to physically swim against currents at ecologically relevant scales is debatable (see Hata et al 2017), and iii) the only paper attempting to validate this in field settings (Dixson et al 2014) has been retracted.</p></li>
<li><p>Benthic boundary layers: coralseed assumes larvae are free flowing in currents and doesn’t account for “sticky” benthic boundary conditions (Jumars &amp; Nowell 1984). A development version of coralseed slows down larvae by 3-fold when p=1 and larvae pass across reef substrates to simulate “searching” behaviour, but this has so far i) been difficult to implement and ii) difficult to parameterise due to a lack of data.</p></li>
</ol>
</section>
</section>
<section id="coralseed-model-workflow-v1.1.0" class="level2">
<h2 class="anchored" data-anchor-id="coralseed-model-workflow-v1.1.0">5. coralseed model workflow (v1.1.0)</h2>
<section id="seed_particles" class="level3">
<h3 class="anchored" data-anchor-id="seed_particles">5.1 seed_particles()</h3>
<p>coralseed simulates larval seeding tracking larvae along dispersal paths and identifying whether trajectories intersect with suitable habitat for settlement. The number of input dispersal paths is equal to the number of simulated larvae, but coralseed can be run iteratively with multiple (i.e.&nbsp;10,000 paths * 100 simulations = 1,000,000 simulated larvae).<br>
seed_particles() is split into three sections: 1) predict_competency() – where along particle tracks do larvae become ready to settle? 2) simulate_mortality() – what proportion of larvae are lost to extrinsic mortality (e.g.&nbsp;predation, entrapment)? 3) habitat_electivity()– if larvae pass over suitable habitats, what is the probability of settling?</p>
</section>
</section>
<section id="predict_competency" class="level2">
<h2 class="anchored" data-anchor-id="predict_competency">5.2 predict_competency()</h2>
<p>One approach to modelling time-censored data is survival analysis, which explicitly considers time-to-event outcomes (Efron 1988). Applying this approach to the settlement experiment, survival analysis becomes “time-to-settlement” rather than “time-to-death”. Each experimental time point can be considered as a census of 100-n larvae from the initial starting pool, with individuals undergoing a binary transition where swimming larvae = “0” and settled larvae = “1”.</p>
<p>coralseed uses three parameterisations of time-to-event models in brms to allow for flexibility in input data types.</p>
<p>The survival function <code>S(t)</code> represents the probability that the event of interest (e.g., settlement or failure) has not occurred by time t. In other words, it gives the probability of surviving past time t. To estimate probability of settlement through time, the settlement data outlined in section 3.2.1 is fit with a Bayesian discrete-time survival model in brms with either i) exponential, ii) Weibull, or iii) lognormal distributions, resulting in posterior distributions for parameters that accounts for between-replicate variability in a multilevel framework:</p>
<pre><code>time | cens(1 - settled) ~ (1 | w | tile)</code></pre>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>